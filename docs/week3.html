<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Week 3: Dictionary-Based Approaches | PS9594: Computational Text Analysis</title>
<meta name="author" content="Dr.¬†Sebasti√°n Vallejo Vera | Western University">
<meta name="description" content="Slides 4 Dictionary-Based Approaches (link or in Perusall)  3.1 Setup As always, we first load the packages that we‚Äôll be using: library(tidyverse) # for wrangling data library(tidylog) # to know...">
<meta name="generator" content="bookdown 0.46 with bs4_book()">
<meta property="og:title" content="Chapter 3 Week 3: Dictionary-Based Approaches | PS9594: Computational Text Analysis">
<meta property="og:type" content="book">
<meta property="og:description" content="Slides 4 Dictionary-Based Approaches (link or in Perusall)  3.1 Setup As always, we first load the packages that we‚Äôll be using: library(tidyverse) # for wrangling data library(tidylog) # to know...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Week 3: Dictionary-Based Approaches | PS9594: Computational Text Analysis">
<meta name="twitter:description" content="Slides 4 Dictionary-Based Approaches (link or in Perusall)  3.1 Setup As always, we first load the packages that we‚Äôll be using: library(tidyverse) # for wrangling data library(tidylog) # to know...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">PS9594: Computational Text Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">‚ÄúComputational Text Analysis‚Äù</a></li>
<li><a class="" href="readings.html">Reading List</a></li>
<li><a class="" href="assignments.html">Assignments</a></li>
<li><a class="" href="replication.html">Replication Exercise</a></li>
<li><a class="" href="final_paper.html">Final Paper</a></li>
<li><a class="" href="week1.html"><span class="header-section-number">1</span> Week 1: A Primer on Using Text as Data</a></li>
<li><a class="" href="week2.html"><span class="header-section-number">2</span> Week 2: Tokenization and Word Frequency</a></li>
<li><a class="active" href="week3.html"><span class="header-section-number">3</span> Week 3: Dictionary-Based Approaches</a></li>
<li><a class="" href="week4.html"><span class="header-section-number">4</span> Week 4: Complexity and Similarity</a></li>
<li><a class="" href="week5.html"><span class="header-section-number">5</span> Week 5: Scaling Techniques (Unsupervised Learning I)</a></li>
<li><a class="" href="week6.html"><span class="header-section-number">6</span> Week 6: Topic Modeling (Unsupervised Learning II)</a></li>
<li><a class="" href="week7.html"><span class="header-section-number">7</span> Week 7: A Primer on Supervised Learning</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/svallejovera/cta_updated">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="week3" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Week 3: Dictionary-Based Approaches<a class="anchor" aria-label="anchor" href="#week3"><i class="fas fa-link"></i></a>
</h1>
<div id="slides-2" class="section level2 unnumbered">
<h2>Slides<a class="anchor" aria-label="anchor" href="#slides-2"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>4 Dictionary-Based Approaches (<a href="https://github.com/svallejovera/cta_updated/blob/main/slides/4%20Dictionary%20Based%20Approaches.pptx">link</a> or in Perusall)</li>
</ul>
</div>
<div id="setup-2" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Setup<a class="anchor" aria-label="anchor" href="#setup-2"><i class="fas fa-link"></i></a>
</h2>
<p>As always, we first load the packages that we‚Äôll be using:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># for wrangling data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/elbersb/tidylog/">tidylog</a></span><span class="op">)</span> <span class="co"># to know what we are wrangling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://juliasilge.github.io/tidytext/">tidytext</a></span><span class="op">)</span> <span class="co"># for 'tidy' manipulation of text data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://emilhvitfeldt.github.io/textdata/">textdata</a></span><span class="op">)</span> <span class="co"># text datasets</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://quanteda.io">quanteda</a></span><span class="op">)</span> <span class="co"># tokenization power house</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://quanteda.io">quanteda.textstats</a></span><span class="op">)</span></span>
<span><span class="co"># Requires installing through devtools: </span></span>
<span><span class="co"># devtools::install_github("kbenoit/quanteda.dictionaries") </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">quanteda.dictionaries</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/karthik/wesanderson">wesanderson</a></span><span class="op">)</span> <span class="co"># to prettify</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span> <span class="co"># for displaying data in html format (relevant for formatting this worksheet mainly)</span></span></code></pre></div>
</div>
<div id="get-data-2" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Get Data:<a class="anchor" aria-label="anchor" href="#get-data-2"><i class="fas fa-link"></i></a>
</h2>
<p>For this example, we will be using data from <em>Ventura et al.¬†(2021) - Connective effervescence and streaming chat during political debates</em>.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/ventura_etal_df.Rdata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ventura_etal_df</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   text_id
## 1       1
## 2       2
## 3       3
## 4       4
## 5       5
## 6       6
##                                                                                                                                                                                                                                       comments
## 1 MORE:\n The coronavirus pandemic's impact on the race will be on display as the\n two candidates won't partake in a handshake, customary at the top of \nsuch events. The size of the audience will also be limited. https://abcn.ws/3kVyl16
## 2                                                                                                                                                           God please bless all Trump supporters. They need it for they know not what they do
## 3                                                                                                                               Trump  is  a  living  disaster!    What  an embarrassment  to  all  human  beings!    The  man  is  dangerous!
## 4                                                                                                                                                   This debate is why other counties laugh at us. School yard class president debate at best.
## 5                                                                    OMG\n ... shut up tRump ... so rude and out of control.  Obviously freaking \nout.  This is a debate NOT a convention or a speech or your platform.  \nLearn some manners
## 6                                                                                                      It‚Äôs\n hard to see what this country has become.  The Presidency is no longer a\n respected position it has lost all of it‚Äôs integrity.
##                      id likes                  debate
## 1              ABC News   100 abc_first_debate_manual
## 2            Anita Hill    61 abc_first_debate_manual
## 3          Dave Garland    99 abc_first_debate_manual
## 4              Carl Roy    47 abc_first_debate_manual
## 5 Lynda Martin-Chambers   154 abc_first_debate_manual
## 6         Nica Merchant   171 abc_first_debate_manual</code></pre>
</div>
<div id="tokenization-etc." class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Tokenization etc.<a class="anchor" aria-label="anchor" href="#tokenization-etc."><i class="fas fa-link"></i></a>
</h2>
<p>The comments are mostly clean, but you can check (on your own) whether they require additional cleaning. In the previous code, I showed you how to lowercase text, remove stopwords, etc., using quanteda. We can also do this using tidytext<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;This code is adapted from Christopher Barrie‚Äôs course on &lt;a href="https://cjbarrie.github.io/CTA-ED/exercise-2-dictionary-based-methods.html"&gt;Computational Text Analysis&lt;/a&gt;.&lt;/p&gt;'><sup>3</sup></a>:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tokenize and lightly clean the `comments` text using tidytext.</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># What this does:</span></span>
<span><span class="co"># 1) lowercases the text in `comments`</span></span>
<span><span class="co"># 2) tokenizes into one-token-per-row using `unnest_tokens()`</span></span>
<span><span class="co"># 3) keeps only tokens that contain at least one lowercase letter (regex check)</span></span>
<span><span class="co"># 4) removes stopwords using the `stop_words` lexicon</span></span>
<span></span>
<span><span class="va">tidy_ventura</span> <span class="op">&lt;-</span> <span class="va">ventura_etal_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Lowercase the raw comment text to standardize tokens (e.g., "Trump" -&gt; "trump")</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>comments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="va">comments</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Tokenize: creates a new column `word` and drops the original `comments` column by default</span></span>
<span>  <span class="fu"><a href="https://juliasilge.github.io/tidytext/reference/unnest_tokens.html">unnest_tokens</a></span><span class="op">(</span><span class="va">word</span>, <span class="va">comments</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Keep only tokens that contain at least one lowercase letter a‚Äìz</span></span>
<span>  <span class="co"># (this removes many punctuation-only / number-only tokens; tweak as needed)</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">word</span>, <span class="st">"[a-z]"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Remove stopwords (common function words like "the", "and", etc.)</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="va">word</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">stop_words</span><span class="op">$</span><span class="va">word</span><span class="op">)</span></span></code></pre></div>
<pre><code>## mutate: changed 29,261 values (99%) of 'comments' (0 new NAs)
## filter: removed 3,374 rows (1%), 494,341 rows remaining
## filter: removed 296,793 rows (60%), 197,548 rows remaining</code></pre>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tidy_ventura</span>, <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code>##    text_id         id likes                  debate        word
## 1        1   ABC News   100 abc_first_debate_manual coronavirus
## 2        1   ABC News   100 abc_first_debate_manual  pandemic's
## 3        1   ABC News   100 abc_first_debate_manual      impact
## 4        1   ABC News   100 abc_first_debate_manual        race
## 5        1   ABC News   100 abc_first_debate_manual     display
## 6        1   ABC News   100 abc_first_debate_manual  candidates
## 7        1   ABC News   100 abc_first_debate_manual     partake
## 8        1   ABC News   100 abc_first_debate_manual   handshake
## 9        1   ABC News   100 abc_first_debate_manual   customary
## 10       1   ABC News   100 abc_first_debate_manual         top
## 11       1   ABC News   100 abc_first_debate_manual      events
## 12       1   ABC News   100 abc_first_debate_manual        size
## 13       1   ABC News   100 abc_first_debate_manual    audience
## 14       1   ABC News   100 abc_first_debate_manual     limited
## 15       1   ABC News   100 abc_first_debate_manual       https
## 16       1   ABC News   100 abc_first_debate_manual     abcn.ws
## 17       1   ABC News   100 abc_first_debate_manual     3kvyl16
## 18       2 Anita Hill    61 abc_first_debate_manual         god
## 19       2 Anita Hill    61 abc_first_debate_manual       bless
## 20       2 Anita Hill    61 abc_first_debate_manual       trump</code></pre>
</div>
<div id="keywords" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Keywords<a class="anchor" aria-label="anchor" href="#keywords"><i class="fas fa-link"></i></a>
</h2>
<p>We can detect the occurrence of the words <strong>trump</strong> and <strong>biden</strong> in each comment (<code>text_id</code>).</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a comment-level dataset indicating whether each comment mentions "trump" and/or "biden" at least once.</span></span>
<span></span>
<span><span class="va">trump_biden</span> <span class="op">&lt;-</span> <span class="va">tidy_ventura</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Create token-level indicator variables (1 if the token is the target word, else 0)</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    trump_token <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">word</span> <span class="op">==</span> <span class="st">"trump"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    biden_token <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">word</span> <span class="op">==</span> <span class="st">"biden"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Aggregate within each comment (grouped by text_id) to mark whether the comment</span></span>
<span>  <span class="co"># contains at least one occurrence of each target word</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">text_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    trump_cmmnt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">trump_token</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    biden_cmmnt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">biden_token</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Reduce to the unit of analysis: one row per comment (text_id)</span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="va">text_id</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">text_id</span>, <span class="va">trump_cmmnt</span>, <span class="va">biden_cmmnt</span>, <span class="va">likes</span>, <span class="va">debate</span><span class="op">)</span></span></code></pre></div>
<pre><code>## mutate: new variable 'trump_token' (double) with 2 unique values and 0% NA
##         new variable 'biden_token' (double) with 2 unique values and 0% NA
## group_by: one grouping variable (text_id)
## mutate (grouped): new variable 'trump_cmmnt' (double) with 2 unique values and 0% NA
##                   new variable 'biden_cmmnt' (double) with 2 unique values and 0% NA
## distinct (grouped): removed 168,013 rows (85%), 29,535 rows remaining (removed 0 groups, 29,535 groups remaining)</code></pre>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">trump_biden</span>, <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 20 √ó 5
## # Groups:   text_id [20]
##    text_id trump_cmmnt biden_cmmnt likes debate                 
##      &lt;int&gt;       &lt;dbl&gt;       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;                  
##  1       1           0           0   100 abc_first_debate_manual
##  2       2           1           0    61 abc_first_debate_manual
##  3       3           1           0    99 abc_first_debate_manual
##  4       4           0           0    47 abc_first_debate_manual
##  5       5           1           0   154 abc_first_debate_manual
##  6       6           0           0   171 abc_first_debate_manual
##  7       7           0           0    79 abc_first_debate_manual
##  8       8           0           0    39 abc_first_debate_manual
##  9       9           0           0    53 abc_first_debate_manual
## 10      10           0           0    36 abc_first_debate_manual
## 11      11           1           0    41 abc_first_debate_manual
## 12      12           0           0    28 abc_first_debate_manual
## 13      13           1           0    54 abc_first_debate_manual
## 14      14           0           0    30 abc_first_debate_manual
## 15      15           1           0    27 abc_first_debate_manual
## 16      16           1           1    31 abc_first_debate_manual
## 17      17           1           0    35 abc_first_debate_manual
## 18      18           1           1    32 abc_first_debate_manual
## 19      19           0           0    34 abc_first_debate_manual
## 20      20           1           0    37 abc_first_debate_manual</code></pre>
<p>Rather than replicating the results from Figure 3 in Ventura et al.¬†(2021), we will estimate the median number of likes that comments mentioning Trump, Biden, both, or neither receive:</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trump_biden</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Create categories</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>mentions_cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">trump_cmmnt</span><span class="op">==</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">biden_cmmnt</span><span class="op">==</span><span class="fl">0</span>, <span class="st">"1. None"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>         mentions_cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">trump_cmmnt</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">biden_cmmnt</span><span class="op">==</span><span class="fl">0</span>, <span class="st">"2. Trump"</span>, <span class="va">mentions_cat</span><span class="op">)</span>,</span>
<span>         mentions_cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">trump_cmmnt</span><span class="op">==</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">biden_cmmnt</span><span class="op">==</span><span class="fl">1</span>, <span class="st">"3. Biden"</span>, <span class="va">mentions_cat</span><span class="op">)</span>,</span>
<span>         mentions_cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">trump_cmmnt</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">biden_cmmnt</span><span class="op">==</span><span class="fl">1</span>, <span class="st">"4. Both"</span>, <span class="va">mentions_cat</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Remove the ones people like too much</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">likes</span> <span class="op">&lt;</span> <span class="fl">26</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">mentions_cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>likes_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">likes</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Plot densities by category, with dashed median lines</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">likes</span>,fill <span class="op">=</span> <span class="va">mentions_cat</span>, color <span class="op">=</span> <span class="va">mentions_cat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/wesanderson/man/wes_palette.html">wes_palette</a></span><span class="op">(</span><span class="st">"BottleRocket2"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/wesanderson/man/wes_palette.html">wes_palette</a></span><span class="op">(</span><span class="st">"BottleRocket2"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">mentions_cat</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">likes_mean</span>, color <span class="op">=</span> <span class="va">mentions_cat</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y <span class="op">=</span> <span class="st">"Density"</span>, color <span class="op">=</span> <span class="st">""</span>, fill <span class="op">=</span> <span class="st">""</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Note: Median likes in dashed lines."</span><span class="op">)</span></span></code></pre></div>
<pre><code>## mutate (grouped): new variable 'mentions_cat' (character) with 4 unique values and 0% NA
## filter (grouped): removed 8,136 rows (28%), 21,399 rows remaining (removed 8,136 groups, 21,399 groups remaining)
## group_by: one grouping variable (mentions_cat)
## mutate (grouped): new variable 'likes_mean' (double) with 3 unique values and 0% NA
## ungroup: no grouping variables remain</code></pre>
<div class="inline-figure"><img src="main_files/figure-html/unnamed-chunk-33-1.png" alt="" width="672"></div>
<p>And we can also see if there are differences across news media:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trump_biden</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Create categories</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>mentions_cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">trump_cmmnt</span><span class="op">==</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">biden_cmmnt</span><span class="op">==</span><span class="fl">0</span>, <span class="st">"1. None"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>         mentions_cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">trump_cmmnt</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">biden_cmmnt</span><span class="op">==</span><span class="fl">0</span>, <span class="st">"2. Trump"</span>, <span class="va">mentions_cat</span><span class="op">)</span>,</span>
<span>         mentions_cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">trump_cmmnt</span><span class="op">==</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">biden_cmmnt</span><span class="op">==</span><span class="fl">1</span>, <span class="st">"3. Biden"</span>, <span class="va">mentions_cat</span><span class="op">)</span>,</span>
<span>         mentions_cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">trump_cmmnt</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">biden_cmmnt</span><span class="op">==</span><span class="fl">1</span>, <span class="st">"4. Both"</span>, <span class="va">mentions_cat</span><span class="op">)</span>,</span>
<span>         media <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">debate</span>, <span class="st">"abc"</span><span class="op">)</span>, <span class="st">"ABC"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>         media <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">debate</span>, <span class="st">"nbc"</span><span class="op">)</span>, <span class="st">"NBC"</span>, <span class="va">media</span><span class="op">)</span>,</span>
<span>         media <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">debate</span>, <span class="st">"fox"</span><span class="op">)</span>, <span class="st">"FOX"</span>, <span class="va">media</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Remove the ones people like too much</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">likes</span> <span class="op">&lt;</span> <span class="fl">26</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">mentions_cat</span>,<span class="va">media</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>median_like <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">likes</span>,na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Plot</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">likes</span>,fill <span class="op">=</span> <span class="va">mentions_cat</span>, color <span class="op">=</span> <span class="va">mentions_cat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/wesanderson/man/wes_palette.html">wes_palette</a></span><span class="op">(</span><span class="st">"BottleRocket2"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/wesanderson/man/wes_palette.html">wes_palette</a></span><span class="op">(</span><span class="st">"BottleRocket2"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">media</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">median_like</span>, color <span class="op">=</span> <span class="va">mentions_cat</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y <span class="op">=</span> <span class="st">"Density"</span>, color <span class="op">=</span> <span class="st">""</span>, fill <span class="op">=</span> <span class="st">""</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Note: Median likes in dashed lines."</span><span class="op">)</span></span></code></pre></div>
<pre><code>## mutate (grouped): new variable 'mentions_cat' (character) with 4 unique values and 0% NA
##                   new variable 'media' (character) with 3 unique values and 0% NA
## filter (grouped): removed 8,136 rows (28%), 21,399 rows remaining (removed 8,136 groups, 21,399 groups remaining)
## group_by: 2 grouping variables (mentions_cat, media)
## mutate (grouped): new variable 'median_like' (double) with 6 unique values and 0% NA
## ungroup: no grouping variables remain</code></pre>
<div class="inline-figure"><img src="main_files/figure-html/unnamed-chunk-34-1.png" alt="" width="672"></div>
<p>Similar to Young and Soroka (2012), we can also explore our keywords of interest in context. This is a good way to validate our proposed measure (e.g., is mentioning <em>trump</em> a reflection of interest, or simply relevance?).</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a quanteda corpus from the Ventura et al. dataset.</span></span>
<span><span class="co"># - text_field indicates which column contains the text to treat as documents.</span></span>
<span><span class="co"># - unique_docnames ensures each document is assigned a unique ID.</span></span>
<span><span class="va">corpus_ventura</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://quanteda.io/reference/corpus.html">corpus</a></span><span class="op">(</span></span>
<span>  <span class="va">ventura_etal_df</span>,</span>
<span>  text_field <span class="op">=</span> <span class="st">"comments"</span>,</span>
<span>  unique_docnames <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tokenize the corpus so we can use token-based tools like kwic()</span></span>
<span><span class="va">toks_ventura</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://quanteda.io/reference/tokens.html">tokens</a></span><span class="op">(</span><span class="va">corpus_ventura</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract "keywords in context" (KWIC) for occurrences of "Trump"</span></span>
<span><span class="co"># This returns the keyword plus a window of surrounding tokens.</span></span>
<span><span class="va">kw_trump</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://quanteda.io/reference/kwic.html">kwic</a></span><span class="op">(</span><span class="va">toks_ventura</span>, pattern <span class="op">=</span> <span class="st">"Trump"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect the first 20 KWIC results</span></span>
<span><span class="co"># (The number of tokens before/after the keyword is controlled by the window size in kwic().)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">kw_trump</span>, <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Keyword-in-context with 20 matches.                                                 
##    [text2, 5]      God please bless all | Trump |
##    [text3, 1]                           | Trump |
##    [text5, 7]               ... shut up | tRump |
##  [text11, 11] a bad opiate problem then | trump |
##   [text13, 4]                 This is a | TRUMP |
##   [text15, 1]                           | Trump |
##   [text16, 8]  this SO much better than | Trump |
##   [text17, 3]                    I love | Trump |
##   [text18, 4]            Biden is right | Trump |
##   [text20, 1]                           | Trump |
##  [text22, 12]     being a decent human. | Trump |
##   [text23, 1]                           | Trump |
##  [text27, 11]          for once, i wish | trump |
##  [text28, 10]             it America... | Trump |
##   [text30, 1]                           | Trump |
##   [text31, 1]                           | Trump |
##   [text32, 1]                           | Trump |
##  [text32, 15]    People open your eyes. | Trump |
##   [text34, 1]                           | Trump |
##   [text36, 1]                           | Trump |
##                                 
##  supporters. They need it       
##  is a living disaster!          
##  ... so rude                    
##  brings up about bidens son     
##  all about ME debate and        
##  is looking pretty flushed right
##  and I wasn‚Äôt even going        
##  ! He is the best               
##  doesn‚Äôt have a plan for        
##  worse president EVER üò° thank  
##  doesn't know the meaning of    
##  such a hateful person he       
##  would shut his trap for        
##  IS NOT smarter than a          
##  has improved our economy and   
##  has done so much harm          
##  is a clown and after           
##  is evil.                       
##  is so broke that is            
##  is literally making this debate</code></pre>
<p>We can also look for more than one word at the same time:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kw_best</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://quanteda.io/reference/kwic.html">kwic</a></span><span class="op">(</span><span class="va">toks_ventura</span>, pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"best"</span>,<span class="st">"worst"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">kw_best</span>, <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Keyword-in-context with 20 matches.                                                       
##    [text4, 17] yard class president debate at | best  |
##    [text10, 1]                                | Worst |
##    [text17, 8]               Trump! He is the | best  |
##    [text43, 6]           This is gonna be the | best  |
##   [text81, 31]  an incompetent President, the | worst |
##   [text81, 33]          President, the worst, | worst |
##   [text81, 35]              the worst, worst, | worst |
##   [text82, 11]         was totally one sided! | Worst |
##    [text86, 8]           right - Trump is the | worst |
##   [text100, 9]             !! BRAVO BRAVO THE | BEST  |
##   [text102, 4]                  Obama was the | worst |
##  [text119, 10]            he said he would do | Best  |
##  [text138, 13]               think. He is the | worst |
##  [text141, 22]           puppet could be? The | worst |
##   [text143, 6]           Trump may not be the | best  |
##  [text158, 15]              This man is a the | worst |
##   [text167, 3]                         He the | worst |
##  [text221, 34]           by far have been the | worst |
##  [text221, 36]           have been the worst, | WORST |
##  [text221, 38]              the worst, WORST, | WORST |
##                                     
##  .                                  
##  debate I‚Äôve ever seen!             
##  president ever! Thank you          
##  show on TV in 4                    
##  , worst, worst in                  
##  , worst in history.                
##  in history.                        
##  ever! Our president kept           
##  president America ever had!        
##  PRESIDENT OF THE WORLD.            
##  president ever!!!                  
##  President ever Crybabies don't like
##  president ever                     
##  president in our time ever         
##  choice but I will choose           
##  thing that has ever happened       
##  president we had in the            
##  , WORST, WORST PRESIDENT           
##  , WORST PRESIDENT!!                
##  PRESIDENT!!!</code></pre>
<p>Alternatively, we can examine which words most commonly occur together. These are called <em>collocations</em> (a concept closely related to <em>n-grams</em>). Here, we want to identify the most common names mentioned (first and last names).</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">toks_ventura</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://quanteda.io/reference/tokens.html">tokens</a></span><span class="op">(</span><span class="va">corpus_ventura</span>, remove_punct <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">col_ventura</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://quanteda.io/reference/tokens_select.html">tokens_select</a></span><span class="op">(</span><span class="va">toks_ventura</span>, </span>
<span>                                <span class="co"># Keep only tokens that start with a capital letter</span></span>
<span>                                pattern <span class="op">=</span> <span class="st">"^[A-Z]"</span>, </span>
<span>                                valuetype <span class="op">=</span> <span class="st">"regex"</span>, </span>
<span>                                case_insensitive <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                padding <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>                  <span class="fu"><a href="https://quanteda.io/reference/textstat_collocations.html">textstat_collocations</a></span><span class="op">(</span>min_count <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="co"># Minimum number of collocations to be taken into account.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">col_ventura</span>, <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code>##          collocation count count_nested length    lambda         z
## 1      chris wallace  1695            0      2  6.752252 128.27065
## 2    president trump   831            0      2  3.747948  84.12773
## 3          joe biden   431            0      2  3.389153  59.43303
## 4           fox news   267            0      2  8.943930  53.78327
## 5       mr president   152            0      2  4.985057  45.89307
## 6      united states   144            0      2 12.106819  36.13493
## 7       donald trump   141            0      2  4.735894  35.48376
## 8         mike pence    40            0      2  8.952895  34.74457
## 9       jo jorgensen    78            0      2 10.969720  34.45690
## 10             HE IS    43            0      2  6.205826  34.13557
## 11  democratic party    38            0      2  9.093924  31.88407
## 12    vice president   347            0      2  8.555551  31.81775
## 13     CHRIS WALLACE    38            0      2  9.634400  31.78949
## 14   PRESIDENT TRUMP    37            0      2  5.845521  30.56607
## 15          TRUMP IS    42            0      2  5.197700  30.15608
## 16       white house    47            0      2 11.387847  29.41946
## 17 african americans    35            0      2  7.750170  29.38751
## 18         JOE BIDEN    25            0      2  7.534616  28.84871
## 19           YOU ARE    27            0      2  6.651381  28.81572
## 20            IS NOT    34            0      2  5.508680  28.73548</code></pre>
<p>(The <span class="math inline">\(\lambda\)</span> score is a measure of how strongly two words are associated, for example, how likely <em>chris</em> and <em>wallace</em> are to occur next to each other. For a complete explanation, you can <a href="http://web.science.mq.edu.au/~mjohnson/papers/2001/dpb-colloc01.pdf">read this paper</a>.)</p>
<p>We can also discover collocations longer than two words. In the example below, we identify collocations consisting of three words.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identify frequent collocations (multi-word expressions) in the Ventura corpus.</span></span>
<span><span class="co"># - tokens_select() is used here mainly to ensure settings are explicit:</span></span>
<span><span class="co">#   * case_insensitive = FALSE keeps case distinctions (e.g., "Trump" vs "trump")</span></span>
<span><span class="co">#   * padding = TRUE preserves token positions so collocations can be detected properly</span></span>
<span><span class="co"># - textstat_collocations() finds statistically associated token sequences.</span></span>
<span><span class="co">#   * min_count sets a minimum frequency threshold (here: at least 100 occurrences)</span></span>
<span><span class="co">#   * size = 3 searches for 3-word collocations (trigrams)</span></span>
<span><span class="va">col_ventura</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://quanteda.io/reference/tokens_select.html">tokens_select</a></span><span class="op">(</span></span>
<span>  <span class="va">toks_ventura</span>,</span>
<span>  case_insensitive <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  padding <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://quanteda.io/reference/textstat_collocations.html">textstat_collocations</a></span><span class="op">(</span>min_count <span class="op">=</span> <span class="fl">100</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect the top 20 collocations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">col_ventura</span>, <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code>##            collocation count count_nested length      lambda           z
## 1          know how to   115            0      3 3.098608190 11.32651308
## 2  the american people   220            0      3 2.602503749 10.16184037
## 3          this is the   158            0      3 1.393392161  9.01490638
## 4           to do with   108            0      3 4.010890138  7.21665079
## 5       this debate is   167            0      3 0.994328169  6.14171313
## 6             is not a   139            0      3 0.796789305  6.08626604
## 7     wallace needs to   172            0      3 1.635032948  4.63118161
## 8         is the worst   110            0      3 1.840376131  3.63917670
## 9            is such a   107            0      3 0.776121492  2.54094422
## 10        trump is the   153            0      3 0.280826175  2.53147919
## 11           is a joke   248            0      3 2.096508909  2.53031226
## 12      trump has done   105            0      3 0.644366045  2.27854315
## 13          trump is a   322            0      3 0.204080417  2.01355366
## 14         this is not   119            0      3 0.447286359  1.99058988
## 15      trump needs to   131            0      3 0.577684570  1.93126531
## 16         what a joke   141            0      3 2.376681732  1.67038242
## 17   the united states   132            0      3 0.738270253  1.43145851
## 18         going to be   122            0      3 1.918098701  1.35112904
## 19         is going to   210            0      3 0.101248917  0.60225753
## 20          biden is a   164            0      3 0.001248882  0.01013271</code></pre>
</div>
<div id="dictionary-approaches" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Dictionary Approaches<a class="anchor" aria-label="anchor" href="#dictionary-approaches"><i class="fas fa-link"></i></a>
</h2>
<p>We can extend the previous analysis by using dictionaries. You can create your own, use previously validated dictionaries, or use dictionaries that are already included in <code>tidytext</code> or <code>quanteda</code> (e.g., for sentiment analysis).</p>
<div id="sentiment-analysis" class="section level3" number="3.5.1">
<h3>
<span class="header-section-number">3.5.1</span> Sentiment Analysis<a class="anchor" aria-label="anchor" href="#sentiment-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>Let‚Äôs look at some pre-loaded sentiment dictionaries in <code>tidytext</code>:</p>
<ul>
<li>
<code>AFFIN</code>: measures sentiment with a numeric score between -5 and 5, and were validated in <a href="http://www2.imm.dtu.dk/pubdb/edoc/imm6006.pdf">this paper</a>.</li>
</ul>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://juliasilge.github.io/tidytext/reference/get_sentiments.html">get_sentiments</a></span><span class="op">(</span><span class="st">"afinn"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 2,477 √ó 2
##    word       value
##    &lt;chr&gt;      &lt;dbl&gt;
##  1 abandon       -2
##  2 abandoned     -2
##  3 abandons      -2
##  4 abducted      -2
##  5 abduction     -2
##  6 abductions    -2
##  7 abhor         -3
##  8 abhorred      -3
##  9 abhorrent     -3
## 10 abhors        -3
## # ‚Ñπ 2,467 more rows</code></pre>
<ul>
<li>
<code>bing</code>: sentiment words found in online forums. More information <a href="https://www.cs.uic.edu/~liub/FBS/sentiment-analysis.html">here</a>.</li>
</ul>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://juliasilge.github.io/tidytext/reference/get_sentiments.html">get_sentiments</a></span><span class="op">(</span><span class="st">"bing"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 6,786 √ó 2
##    word        sentiment
##    &lt;chr&gt;       &lt;chr&gt;    
##  1 2-faces     negative 
##  2 abnormal    negative 
##  3 abolish     negative 
##  4 abominable  negative 
##  5 abominably  negative 
##  6 abominate   negative 
##  7 abomination negative 
##  8 abort       negative 
##  9 aborted     negative 
## 10 aborts      negative 
## # ‚Ñπ 6,776 more rows</code></pre>
<ul>
<li>
<code>nrc</code>: underpaid workers from Amazon mechanical Turk coded the emotional valence of a long list of terms, which were validated in <a href="https://arxiv.org/pdf/1308.6297.pdf">this paper</a>. Also, check this paper about MTurk, and <a href="https://link.springer.com/article/10.3758/s13428-025-02852-7">why you shouldn‚Äôt trust data collected on MTurk</a>.</li>
</ul>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://juliasilge.github.io/tidytext/reference/get_sentiments.html">get_sentiments</a></span><span class="op">(</span><span class="st">"nrc"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 13,872 √ó 2
##    word        sentiment
##    &lt;chr&gt;       &lt;chr&gt;    
##  1 abacus      trust    
##  2 abandon     fear     
##  3 abandon     negative 
##  4 abandon     sadness  
##  5 abandoned   anger    
##  6 abandoned   fear     
##  7 abandoned   negative 
##  8 abandoned   sadness  
##  9 abandonment anger    
## 10 abandonment fear     
## # ‚Ñπ 13,862 more rows</code></pre>
<p>Each dictionary classifies and quantifies words in a different way. Let‚Äôs use the <code>nrc</code> sentiment dictionary to analyze our comments dataset. The <code>nrc</code> dictionary classifies, among other concepts, words as reflecting <em>positive</em> or <em>negative</em> sentiment.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nrc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://juliasilge.github.io/tidytext/reference/get_sentiments.html">get_sentiments</a></span><span class="op">(</span><span class="st">"nrc"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">nrc</span><span class="op">$</span><span class="va">sentiment</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##        anger anticipation      disgust         fear          joy 
##         1245          837         1056         1474          687 
##     negative     positive      sadness     surprise        trust 
##         3316         2308         1187          532         1230</code></pre>
<p>We will focus solely on <em>positive</em> or <em>negative</em> sentiment:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nrc_pos_neg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://juliasilge.github.io/tidytext/reference/get_sentiments.html">get_sentiments</a></span><span class="op">(</span><span class="st">"nrc"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">sentiment</span> <span class="op">==</span> <span class="st">"positive"</span> <span class="op">|</span> <span class="va">sentiment</span> <span class="op">==</span> <span class="st">"negative"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## filter: removed 8,248 rows (59%), 5,624 rows remaining</code></pre>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ventura_pos_neg</span> <span class="op">&lt;-</span> <span class="va">tidy_ventura</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">nrc_pos_neg</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Joining with `by = join_by(word)`
## left_join: added one column (sentiment)
## &gt; rows only in x 147,204
## &gt; rows only in nrc_pos_neg ( 3,402)
## &gt; matched rows 52,059 (includes duplicates)
## &gt; =========
## &gt; rows total 199,263</code></pre>
<p>Let‚Äôs check the top <em>positive</em> words and the top <em>negative</em> words:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ventura_pos_neg</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">sentiment</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">word</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## group_by: one grouping variable (sentiment)
## count: now 14,242 rows and 3 columns, one group variable remaining (sentiment)</code></pre>
<pre><code>## # A tibble: 14,242 √ó 3
## # Groups:   sentiment [3]
##    sentiment word          n
##    &lt;chr&gt;     &lt;chr&gt;     &lt;int&gt;
##  1 &lt;NA&gt;      trump     11676
##  2 &lt;NA&gt;      biden      7847
##  3 positive  president  4920
##  4 &lt;NA&gt;      wallace    4188
##  5 positive  debate     2693
##  6 &lt;NA&gt;      people     2591
##  7 &lt;NA&gt;      chris      2559
##  8 &lt;NA&gt;      joe        2380
##  9 &lt;NA&gt;      country    1589
## 10 &lt;NA&gt;      time       1226
## # ‚Ñπ 14,232 more rows</code></pre>
<p>Some classifications make intuitive sense: ‚Äúlove‚Äù is <em>positive</em> and ‚Äúbully‚Äù is <em>negative</em>. Others are less convincing: ‚Äútalk‚Äù is positive? ‚Äújoke‚Äù is negative? Some depend heavily on context: ‚Äúvice‚Äù is negative, but <em>vice president</em> typically is not (especially since ‚Äúpresident‚Äù is classified as ‚Äúpositive,‚Äù which‚Ä¶ really?). And then ‚Äúvote‚Äù is both positive and negative, which‚Ä¶ what?</p>
<p>Let‚Äôs turn a blind eye for now (but, once again, see Grimmer et al., Chapter 15 for best practices).</p>
<p>Do people who watch different news media use different language? Let‚Äôs see what the data tell us. As always, check the unit of analysis in your dataset. In this case, each observation is a word, but we have a grouping variable for the comment (<code>text_id</code>), so we can count how many <em>positive</em> and <em>negative</em> words appear in each comment. We will calculate a net sentiment score by subtracting the number of negative words from the number of positive words (within each comment).</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comment_pos_neg</span> <span class="op">&lt;-</span> <span class="va">ventura_pos_neg</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Create dummies of pos and neg for counting</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>pos_dum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">sentiment</span> <span class="op">==</span> <span class="st">"positive"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>         neg_dum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">sentiment</span> <span class="op">==</span> <span class="st">"negative"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Estimate total number of tokens per comment, pos , and negs</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">text_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>total_words <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>         total_pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pos_dum</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>         total_neg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">neg_dum</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># These values are aggregated at the text_id level so we can eliminate repeated text_id</span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="va">text_id</span>,.keep_all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Now we estimate the net sentiment score. You can change this and get a different way to measure the ratio of positive to negative</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>net_sent <span class="op">=</span> <span class="va">total_pos</span> <span class="op">-</span> <span class="va">total_neg</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<pre><code>## mutate: new variable 'pos_dum' (double) with 3 unique values and 74% NA
##         new variable 'neg_dum' (double) with 3 unique values and 74% NA
## group_by: one grouping variable (text_id)
## mutate (grouped): new variable 'total_words' (integer) with 25 unique values and 0% NA
##                   new variable 'total_pos' (double) with 14 unique values and 0% NA
##                   new variable 'total_neg' (double) with 10 unique values and 0% NA
## distinct (grouped): removed 169,728 rows (85%), 29,535 rows remaining (removed 0 groups, 29,535 groups remaining)
## mutate (grouped): new variable 'net_sent' (double) with 21 unique values and 0% NA
## ungroup: no grouping variables remain</code></pre>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note that the `word` and `sentiment` columns are meaningless now</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">comment_pos_neg</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 10 √ó 12
##    text_id id    likes debate word  sentiment pos_dum neg_dum total_words
##      &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;       &lt;int&gt;
##  1       1 ABC ‚Ä¶   100 abc_f‚Ä¶ coro‚Ä¶ &lt;NA&gt;           NA      NA          17
##  2       2 Anit‚Ä¶    61 abc_f‚Ä¶ god   positive        1       0           4
##  3       3 Dave‚Ä¶    99 abc_f‚Ä¶ trump &lt;NA&gt;           NA      NA           6
##  4       4 Carl‚Ä¶    47 abc_f‚Ä¶ deba‚Ä¶ positive        1       0           8
##  5       5 Lynd‚Ä¶   154 abc_f‚Ä¶ omg   &lt;NA&gt;           NA      NA          12
##  6       6 Nica‚Ä¶   171 abc_f‚Ä¶ it‚Äôs  &lt;NA&gt;           NA      NA           9
##  7       7 Conn‚Ä¶    79 abc_f‚Ä¶ happ‚Ä¶ &lt;NA&gt;           NA      NA           7
##  8       8 Tamm‚Ä¶    39 abc_f‚Ä¶ expe‚Ä¶ &lt;NA&gt;           NA      NA           4
##  9       9 Susa‚Ä¶    53 abc_f‚Ä¶ smart &lt;NA&gt;           NA      NA          13
## 10      10 Dana‚Ä¶    36 abc_f‚Ä¶ worst &lt;NA&gt;           NA      NA          15
## # ‚Ñπ 3 more variables: total_pos &lt;dbl&gt;, total_neg &lt;dbl&gt;, net_sent &lt;dbl&gt;</code></pre>
<p>Ok, now we can plot the differences:</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comment_pos_neg</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="co"># Create categories</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>media <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">debate</span>, <span class="st">"abc"</span><span class="op">)</span>, <span class="st">"ABC"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>         media <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">debate</span>, <span class="st">"nbc"</span><span class="op">)</span>, <span class="st">"NBC"</span>, <span class="va">media</span><span class="op">)</span>,</span>
<span>         media <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">debate</span>, <span class="st">"fox"</span><span class="op">)</span>, <span class="st">"FOX"</span>, <span class="va">media</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">media</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>median_sent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">net_sent</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">net_sent</span>,color<span class="op">=</span><span class="va">media</span>,fill<span class="op">=</span><span class="va">media</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>                 binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/wesanderson/man/wes_palette.html">wes_palette</a></span><span class="op">(</span><span class="st">"BottleRocket2"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/wesanderson/man/wes_palette.html">wes_palette</a></span><span class="op">(</span><span class="st">"BottleRocket2"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">media</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">median_sent</span>, color <span class="op">=</span> <span class="va">media</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y <span class="op">=</span> <span class="st">"Count"</span>, color <span class="op">=</span> <span class="st">""</span>, fill <span class="op">=</span> <span class="st">""</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Note: Mean net sentiment in dashed lines."</span><span class="op">)</span></span></code></pre></div>
<pre><code>## mutate: new variable 'media' (character) with 3 unique values and 0% NA
## group_by: one grouping variable (media)
## mutate (grouped): new variable 'median_sent' (double) with 3 unique values and 0% NA</code></pre>
<div class="inline-figure"><img src="main_files/figure-html/unnamed-chunk-46-1.png" alt="" width="672"></div>
</div>
<div id="domain-specific-dictionaries" class="section level3" number="3.5.2">
<h3>
<span class="header-section-number">3.5.2</span> Domain-Specific Dictionaries<a class="anchor" aria-label="anchor" href="#domain-specific-dictionaries"><i class="fas fa-link"></i></a>
</h3>
<p>Sentiment dictionaries are common, but you can build a dictionary for <em>any</em> concept you‚Äôre interested in. As long as you can create a lexicon (and validate it), you can conduct an analysis similar to the one we just carried out. This time, rather than using an off-the-shelf sentiment dictionary, we will create our own. Let‚Äôs try a dictionary for two topics: the economy and migration.</p>
<p>As long as the dictionary has the same structure as our <code>nrc_pos_neg</code> object, we can follow the same process we used for the sentiment dictionary.</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define two simple, domain-specific dictionaries (lexicons) for:</span></span>
<span><span class="co"># 1) the economy and 2) migration.</span></span>
<span><span class="co"># Each dictionary is a two-column data frame with:</span></span>
<span><span class="co"># - word:  the token to match in the text</span></span>
<span><span class="co"># - topic: the category/label we want to assign when that token appears</span></span>
<span></span>
<span><span class="va">economy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"economy"</span>, <span class="st">"taxes"</span>, <span class="st">"inflation"</span>, <span class="st">"debt"</span>, <span class="st">"employment"</span>, <span class="st">"jobs"</span><span class="op">)</span>,</span>
<span>  <span class="st">"economy"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">economy</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"word"</span>, <span class="st">"topic"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">migration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"immigrants"</span>, <span class="st">"border"</span>, <span class="st">"wall"</span>, <span class="st">"alien"</span>, <span class="st">"migrant"</span>, <span class="st">"visa"</span>, <span class="st">"daca"</span>, <span class="st">"dreamer"</span><span class="op">)</span>,</span>
<span>  <span class="st">"migration"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">migration</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"word"</span>, <span class="st">"topic"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine the two topic-specific lexicons into a single dictionary object</span></span>
<span><span class="va">dict</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind.data.frame</a></span><span class="op">(</span><span class="va">economy</span>, <span class="va">migration</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect the resulting dictionary</span></span>
<span><span class="va">dict</span></span></code></pre></div>
<pre><code>##          word     topic
## 1     economy   economy
## 2       taxes   economy
## 3   inflation   economy
## 4        debt   economy
## 5  employment   economy
## 6        jobs   economy
## 7  immigrants migration
## 8      border migration
## 9        wall migration
## 10      alien migration
## 11    migrant migration
## 12       visa migration
## 13       daca migration
## 14    dreamer migration</code></pre>
<p>Let‚Äôs see if we find some of these words in our comments:</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ventura_topic</span> <span class="op">&lt;-</span> <span class="va">tidy_ventura</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">dict</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Joining with `by = join_by(word)`
## left_join: added one column (topic)
## &gt; rows only in x 196,175
## &gt; rows only in dict ( 3)
## &gt; matched rows 1,373
## &gt; =========
## &gt; rows total 197,548</code></pre>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ventura_topic</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">topic</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">topic</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">word</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## filter: removed 196,175 rows (99%), 1,373 rows remaining
## group_by: one grouping variable (topic)
## count: now 11 rows and 3 columns, one group variable remaining (topic)</code></pre>
<pre><code>## # A tibble: 11 √ó 3
## # Groups:   topic [2]
##    topic     word           n
##    &lt;chr&gt;     &lt;chr&gt;      &lt;int&gt;
##  1 economy   taxes        680
##  2 economy   economy      328
##  3 economy   jobs         273
##  4 migration wall          34
##  5 economy   debt          32
##  6 migration immigrants    12
##  7 migration border         7
##  8 economy   employment     3
##  9 migration alien          2
## 10 migration daca           1
## 11 migration visa           1</code></pre>
<p>Not that many. Note that we did not stem or lemmatize our corpus, so if we want to capture ‚Äújob‚Äù <em>and</em> ‚Äújobs,‚Äù we need to include both in our dictionary. In other words, any preprocessing steps we apply to the corpus should also be applied to the dictionary.</p>
<p>If you are a bit more versed in R, you will notice that dictionaries are often represented as lists. <code>quanteda</code> understands dictionaries as lists, so we can build them that way and use its <code><a href="https://rdrr.io/pkg/quanteda.dictionaries/man/liwcalike.html">liwcalike()</a></code> function to find matching words in text. An added benefit is that we can use <a href="https://linuxhint.com/bash_globbing_tutorial/">glob</a> patterns to capture variations of the same word (e.g., <code>job*</code> will match ‚Äújob,‚Äù ‚Äújobs,‚Äù and ‚Äújobless‚Äù).</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dict</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://quanteda.io/reference/dictionary.html">dictionary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>economy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"econom*"</span>,<span class="st">"tax*"</span>,<span class="st">"inflation"</span>,<span class="st">"debt*"</span>,<span class="st">"employ*"</span>,<span class="st">"job*"</span><span class="op">)</span>,</span>
<span>                        immigration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"immigrant*"</span>,<span class="st">"border"</span>,<span class="st">"wall"</span>,<span class="st">"alien"</span>,<span class="st">"migrant*"</span>,<span class="st">"visa*"</span>,<span class="st">"daca"</span>,<span class="st">"dreamer*"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># liwcalike lowercases input text</span></span>
<span><span class="va">ventura_topics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/quanteda.dictionaries/man/liwcalike.html">liwcalike</a></span><span class="op">(</span><span class="va">ventura_etal_df</span><span class="op">$</span><span class="va">comments</span>,</span>
<span>                               dictionary <span class="op">=</span> <span class="va">dict</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># liwcalike keeps the order so we can cbind them directly</span></span>
<span><span class="va">topics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span><span class="op">(</span><span class="va">ventura_etal_df</span>,<span class="va">ventura_topics</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Look only at the comments that mention the economy and immigration</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">topics</span><span class="op">[</span><span class="va">topics</span><span class="op">$</span><span class="va">economy</span><span class="op">&gt;</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">topics</span><span class="op">$</span><span class="va">immigration</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>##       text_id
## 4998     4999
## 6475     6477
## 8098     8113
## 12331   32211
## 14345   34225
## 19889   62164
##                                                                                                                                              comments
## 4998                           Trump is going to create jobs to finish that wall,  hows that working for ya?  I don‚Äôt see Mexico paying for it either
## 6475                           Trump is trash illegal immigrants pay more taxes than this man and you guys support this broke failure con billionaire
## 8098                                  $750.00 in taxes in two years?????   BUT HE'S ALL OVER THE PLACE INSULTING IMMIGRANTS WHO PAID MORE IN TAXES!!!
## 12331    Ask\n Biden how much he will raise taxes to pay for all the things he says he\n is going to provide everyone - including illegal immigrants!
## 14345 Trump has been living the life and does not care for the hard working American...His taxes are not the only rip off...Investigate Wall Money...
## 19889                                                               Vote trump out. He needs to pay taxes too ... immigrants pay more than that thief
##                        id likes                  debate   docname
## 4998         Ellen Lustic    NA abc_first_debate_manual  text4998
## 6475      Kevin G Vazquez     1 abc_first_debate_manual  text6475
## 8098      Prince M Dorbor     1 abc_first_debate_manual  text8098
## 12331 Lynne Basista Shine     6 fox_first_debate_manual text12331
## 14345          RJ Jimenez     4 fox_first_debate_manual text14345
## 19889      Nicole Brennan    13 nbc_first_debate_manual text19889
##       Segment      WPS WC Sixltr   Dic economy immigration AllPunc
## 4998     4998 12.50000 25   4.00  8.00    4.00        4.00   12.00
## 6475     6475 20.00000 20  25.00 10.00    5.00        5.00    0.00
## 8098     8098 14.00000 28   7.14 10.71    7.14        3.57   35.71
## 12331   12331 27.00000 27  18.52  7.41    3.70        3.70    7.41
## 14345   14345 11.66667 35   8.57  5.71    2.86        2.86   25.71
## 19889   19889  9.50000 19   5.26 10.53    5.26        5.26   21.05
##       Period Comma Colon SemiC QMark Exclam Dash Quote Apostro Parenth
## 4998    0.00     4     0     0  4.00   0.00  0.0  4.00    4.00       0
## 6475    0.00     0     0     0  0.00   0.00  0.0  0.00    0.00       0
## 8098    3.57     0     0     0 17.86  10.71  0.0  3.57    3.57       0
## 12331   0.00     0     0     0  0.00   3.70  3.7  0.00    0.00       0
## 14345  25.71     0     0     0  0.00   0.00  0.0  0.00    0.00       0
## 19889  21.05     0     0     0  0.00   0.00  0.0  0.00    0.00       0
##       OtherP
## 4998    8.00
## 6475    0.00
## 8098   35.71
## 12331   3.70
## 14345  25.71
## 19889  21.05</code></pre>
<p>The output provides some interesting information. First, <code>economy</code> and <code>immigration</code> give us the <em>percentage</em> of words in the text that match our economy or immigration dictionaries. In general, we would not expect many words in a sentence to reference, for example, ‚Äújobs‚Äù for us to conclude that the sentence is about the economy. So, any value above 0% can be interpreted as mentioning the economy (unless you have theoretical reasons to treat, say, 3% as meaningfully different from 2%). For the remaining variables:</p>
<ul>
<li>
<code>WPS</code>: Words per sentence.</li>
<li>
<code>WC</code>: Word count.</li>
<li>
<code>Sixltr</code>: Six-letter words (%).</li>
<li>
<code>Dic</code>: % of words in the dictionary.</li>
<li>
<code>Allpunct</code>: % of all punctuation marks.</li>
<li>
<code>Period</code> to <code>OtherP</code>: % of specific punctuation marks.</li>
</ul>
<p>With this information, we can identify which users focus more on each topic:</p>
<pre><code>## mutate: new variable 'media' (character) with 3 unique values and 0% NA
##         new variable 'economy_dum' (double) with 2 unique values and 0% NA
##         new variable 'immigration_dum' (double) with 2 unique values and 0% NA
## group_by: one grouping variable (media)
## mutate (grouped): new variable 'pct_econ' (double) with 3 unique values and 0% NA
##                   new variable 'pct_migr' (double) with 3 unique values and 0% NA
## distinct (grouped): removed 29,544 rows (&gt;99%), 3 rows remaining (removed 0 groups, 3 groups remaining)</code></pre>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:unnamed-chunk-50">Table 3.1: </span>% of mentions by topic and media outlet.</caption>
<thead><tr class="header">
<th align="left">media</th>
<th align="right">pct_econ</th>
<th align="right">pct_migr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ABC</td>
<td align="right">0.0641299</td>
<td align="right">0.0030441</td>
</tr>
<tr class="even">
<td align="left">FOX</td>
<td align="right">0.0856325</td>
<td align="right">0.0008175</td>
</tr>
<tr class="odd">
<td align="left">NBC</td>
<td align="right">0.0708661</td>
<td align="right">0.0018171</td>
</tr>
</tbody>
</table></div>
</div>
<div id="using-pre-built-dictionaries" class="section level3" number="3.5.3">
<h3>
<span class="header-section-number">3.5.3</span> Using Pre-Built Dictionaries<a class="anchor" aria-label="anchor" href="#using-pre-built-dictionaries"><i class="fas fa-link"></i></a>
</h3>
<p>So far, we have seen how to apply pre-loaded dictionaries (e.g., sentiment) and how to apply our own dictionaries. What if you have a pre-built dictionary that you want to apply to your corpus? As long as the dictionary has the correct structure, we can use the techniques we have applied so far. This also means that you may need to do some data wrangling, since pre-built dictionaries come in many formats.</p>
<p>Let‚Äôs use the NRC Affect Intensity Lexicon (created by the same team behind the pre-loaded <code>nrc</code> sentiment dictionary). The NRC Affect Intensity Lexicon measures the intensity of an emotion on a scale from 0 (low) to 1 (high). For example, ‚Äúdefiance‚Äù has an anger intensity of 0.51, and ‚Äúhate‚Äù has an anger intensity of 0.83.</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">intense_lex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/NRC-AffectIntensity-Lexicon.txt"</span>, fill <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">intense_lex</span><span class="op">)</span></span></code></pre></div>
<pre><code>##         term score AffectDimension
## 1   outraged 0.964           anger
## 2  brutality 0.959           anger
## 3     hatred 0.953           anger
## 4    hateful 0.940           anger
## 5  terrorize 0.939           anger
## 6 infuriated 0.938           anger</code></pre>
<p>This is more than a simple dictionary: the key advantage is that it provides an <em>intensity</em> score for each word, which gives us more variation in our analysis (e.g., instead of a binary anger/no-anger measure, we can analyze degrees of anger). We will use the <code>tidytext</code> approach to analyze degrees of ‚Äújoy‚Äù in our corpus.</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">joy_lex</span> <span class="op">&lt;-</span> <span class="va">intense_lex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">AffectDimension</span><span class="op">==</span><span class="st">"joy"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>word<span class="op">=</span><span class="va">term</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">word</span>,<span class="va">AffectDimension</span>,<span class="va">score</span><span class="op">)</span></span></code></pre></div>
<pre><code>## filter: removed 4,546 rows (78%), 1,268 rows remaining
## mutate: new variable 'word' (character) with 1,268 unique values and 0% NA</code></pre>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ventura_joy</span> <span class="op">&lt;-</span> <span class="va">tidy_ventura</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">joy_lex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co">## Most of the comments have no joy words so we will change these NAs to 0 but this is an ad-hoc decision. This decision must be theoretically motivated and justified</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">score</span><span class="op">)</span>,<span class="fl">0</span>,<span class="va">score</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Joining with `by = join_by(word)`
## left_join: added 2 columns (AffectDimension, score)
## &gt; rows only in x 184,943
## &gt; rows only in joy_lex ( 769)
## &gt; matched rows 12,605
## &gt; =========
## &gt; rows total 197,548
## mutate: changed 184,943 values (94%) of 'score' (184,943 fewer NAs)</code></pre>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ventura_joy</span><span class="op">[</span><span class="va">ventura_joy</span><span class="op">$</span><span class="va">score</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>##    text_id           id likes                  debate       word
## 18       2   Anita Hill    61 abc_first_debate_manual        god
## 19       2   Anita Hill    61 abc_first_debate_manual      bless
## 23       3 Dave Garland    99 abc_first_debate_manual     living
## 30       4     Carl Roy    47 abc_first_debate_manual      laugh
## 64       8  Tammy Eisen    39 abc_first_debate_manual experience
## 65       8  Tammy Eisen    39 abc_first_debate_manual      share
##    AffectDimension score
## 18             joy 0.545
## 19             joy 0.561
## 23             joy 0.312
## 30             joy 0.891
## 64             joy 0.375
## 65             joy 0.438</code></pre>
<p>Now, we can see the relationship between <code>likes</code> and <code>joy</code>:</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span> <span class="co"># To add the negative binomial fitted line</span></span>
<span></span>
<span><span class="va">ventura_joy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>media <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">debate</span>, <span class="st">"abc"</span><span class="op">)</span>, <span class="st">"ABC"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>         media <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">debate</span>, <span class="st">"nbc"</span><span class="op">)</span>, <span class="st">"NBC"</span>, <span class="va">media</span><span class="op">)</span>,</span>
<span>         media <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">debate</span>, <span class="st">"fox"</span><span class="op">)</span>, <span class="st">"FOX"</span>, <span class="va">media</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Calculate mean joy in each comment</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">text_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>mean_joy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">score</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="va">text_id</span>,<span class="va">mean_joy</span>,<span class="va">likes</span>,<span class="va">media</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Let's only look at comments that had SOME joy in them</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">mean_joy</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Remove the ones people like too much</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">likes</span> <span class="op">&lt;</span> <span class="fl">26</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Plot</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">mean_joy</span>,y<span class="op">=</span><span class="va">likes</span>,color<span class="op">=</span><span class="va">media</span>,fill<span class="op">=</span><span class="va">media</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"glm.nb"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/wesanderson/man/wes_palette.html">wes_palette</a></span><span class="op">(</span><span class="st">"BottleRocket2"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/wesanderson/man/wes_palette.html">wes_palette</a></span><span class="op">(</span><span class="st">"BottleRocket2"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">media</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Mean Joy"</span>, y <span class="op">=</span> <span class="st">"Likes"</span>, color <span class="op">=</span> <span class="st">""</span>, fill <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<pre><code>## mutate: new variable 'media' (character) with 3 unique values and 0% NA
## group_by: one grouping variable (text_id)
## mutate (grouped): new variable 'mean_joy' (double) with 3,118 unique values and 0% NA
## distinct (grouped): removed 168,013 rows (85%), 29,535 rows remaining (removed 0 groups, 29,535 groups remaining)
## ungroup: no grouping variables remain
## filter: removed 20,355 rows (69%), 9,180 rows remaining
## filter: removed 2,518 rows (27%), 6,662 rows remaining
## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<div class="inline-figure"><img src="main_files/figure-html/unnamed-chunk-53-1.png" alt="" width="672"></div>
<p>Finally, for the sake of showing the process, I will write the code to load the dictionary using <code>quanteda</code>, but note that this approach loses all the intensity information.</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">affect_dict</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://quanteda.io/reference/dictionary.html">dictionary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>anger <span class="op">=</span> <span class="va">intense_lex</span><span class="op">$</span><span class="va">term</span><span class="op">[</span><span class="va">intense_lex</span><span class="op">$</span><span class="va">AffectDimension</span><span class="op">==</span><span class="st">"anger"</span><span class="op">]</span>,</span>
<span>                        fear <span class="op">=</span> <span class="va">intense_lex</span><span class="op">$</span><span class="va">term</span><span class="op">[</span><span class="va">intense_lex</span><span class="op">$</span><span class="va">AffectDimension</span><span class="op">==</span><span class="st">"fear"</span><span class="op">]</span>,</span>
<span>                        joy <span class="op">=</span> <span class="va">intense_lex</span><span class="op">$</span><span class="va">term</span><span class="op">[</span><span class="va">intense_lex</span><span class="op">$</span><span class="va">AffectDimension</span><span class="op">==</span><span class="st">"joy"</span><span class="op">]</span>,</span>
<span>                        sadness <span class="op">=</span> <span class="va">intense_lex</span><span class="op">$</span><span class="va">term</span><span class="op">[</span><span class="va">intense_lex</span><span class="op">$</span><span class="va">AffectDimension</span><span class="op">==</span><span class="st">"sadness"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">ventura_affect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/quanteda.dictionaries/man/liwcalike.html">liwcalike</a></span><span class="op">(</span><span class="va">ventura_etal_df</span><span class="op">$</span><span class="va">comments</span>,</span>
<span>                               dictionary <span class="op">=</span> <span class="va">affect_dict</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># liwcalike keeps the order so we can cbind them directly</span></span>
<span><span class="va">affect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span><span class="op">(</span><span class="va">ventura_etal_df</span>,<span class="va">ventura_affect</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Look only at the comments that have anger and fear</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">affect</span><span class="op">[</span><span class="va">affect</span><span class="op">$</span><span class="va">anger</span><span class="op">&gt;</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">affect</span><span class="op">$</span><span class="va">fear</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>##    text_id
## 3        3
## 7        7
## 9        9
## 11      11
## 12      12
## 23      23
##                                                                                                                                                                                       comments
## 3                                                                               Trump  is  a  living  disaster!    What  an embarrassment  to  all  human  beings!    The  man  is  dangerous!
## 7                                                                                  What happened to the days when it was a debate not a bully session! I am so ashamed of this administration!
## 9  ......\n a smart president?  A thief, a con man, and a liar that has taken tax \npayers money to his own properties.  A liar that knew the magnitude of \nthe virus and did not address it.
## 11                             with\n the usa having such a bad opiate problem then trump brings up about \nbidens son is the most disgraceful thing any human being could do...vote\n him out
## 12   Trump‚Äôs\n only recourse in the debate is to demean his opponent and talk about \nwhat a great man he, himself is. Turn his mic off when it‚Äôs not his turn\n to speak. Nothing but babble!
## 23                                                                                           Trump such a hateful person he has no moral or respect in a debate he blames everyone except him.
##              id likes                  debate docname Segment       WPS
## 3  Dave Garland    99 abc_first_debate_manual   text3       3  6.333333
## 7   Connie Sage    79 abc_first_debate_manual   text7       7 11.500000
## 9  Susan Weyant    53 abc_first_debate_manual   text9       9 15.333333
## 11  Lynn Kohler    41 abc_first_debate_manual  text11      11 32.000000
## 12     Jim Lape    28 abc_first_debate_manual  text12      12 13.000000
## 23   Joe Sonera    65 abc_first_debate_manual  text23      23 20.000000
##    WC Sixltr   Dic anger  fear  joy sadness AllPunc Period Comma Colon
## 3  19  15.79 36.84  5.26 15.79 5.26   10.53   15.79   0.00  0.00     0
## 7  23  17.39 17.39  4.35  4.35 0.00    8.70    8.70   0.00  0.00     0
## 9  46   8.70 13.04  4.35  2.17 2.17    4.35   23.91  17.39  4.35     0
## 11 32   6.25 28.12  9.38  6.25 3.12    9.38    9.38   9.38  0.00     0
## 12 39  12.82  5.13  2.56  2.56 0.00    0.00   15.38   5.13  2.56     0
## 23 20  15.00 25.00 10.00  5.00 5.00    5.00    5.00   5.00  0.00     0
##    SemiC QMark Exclam Dash Quote Apostro Parenth OtherP
## 3      0  0.00  15.79    0  0.00    0.00       0  15.79
## 7      0  0.00   8.70    0  0.00    0.00       0   8.70
## 9      0  2.17   0.00    0  0.00    0.00       0  23.91
## 11     0  0.00   0.00    0  0.00    0.00       0   9.38
## 12     0  0.00   2.56    0  5.13    5.13       0  10.26
## 23     0  0.00   0.00    0  0.00    0.00       0   5.00</code></pre>
</div>
</div>
<div id="assignments-1---due-date-eod-friday-week-4-1" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Assignments 1 - Due Date: EOD Friday Week 4<a class="anchor" aria-label="anchor" href="#assignments-1---due-date-eod-friday-week-4-1"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Replicate the results from the left-most column of Figure 3 in Ventura et al.¬†(2021).</li>
<li>Look at the keywords in context for <em>Biden</em> in the <code>ventura_etal_df</code> dataset, and compare the results with the same data, but pre-processed (i.e., lower-case, remove stopwords, etc.). Which version provides more information about the context in which <em>Biden</em> appears in the comments?</li>
<li>Use a different collocation approach with the <code>ventura_etal_df</code> dataset, but pre-process the data (i.e., lower-case, remove stopwords, etc.). Which approach (pre-processed or not pre-processed) provides a better picture of the corpus or of the collocations you found?</li>
<li>Compare the <strong>positive</strong> sentiment of comments mentioning <em>trump</em> and comments mentioning <em>biden</em> using <code>bing</code> and <code>afinn</code>. Note that <code>afinn</code> gives a numeric value, so you will need to choose a threshold to determine <strong>positive</strong> sentiment.</li>
<li>Using <code>bing</code>, compare the sentiment of comments mentioning <em>trump</em> and comments mentioning <em>biden</em> using different metrics (e.g., Young and Soroka 2012, Martins and Baumard 2020, Ventura et al.¬†2021).</li>
<li>Create your own domain-specific dictionary and apply it to the <code>ventura_etal_df</code> dataset. Show the limitations of your dictionary (e.g., false positives), and comment on how much of a problem this would be if you wanted to conduct an analysis of this corpus.</li>
</ol>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="week2.html"><span class="header-section-number">2</span> Week 2: Tokenization and Word Frequency</a></div>
<div class="next"><a href="week4.html"><span class="header-section-number">4</span> Week 4: Complexity and Similarity</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#week3"><span class="header-section-number">3</span> Week 3: Dictionary-Based Approaches</a></li>
<li><a class="nav-link" href="#slides-2">Slides</a></li>
<li><a class="nav-link" href="#setup-2"><span class="header-section-number">3.1</span> Setup</a></li>
<li><a class="nav-link" href="#get-data-2"><span class="header-section-number">3.2</span> Get Data:</a></li>
<li><a class="nav-link" href="#tokenization-etc."><span class="header-section-number">3.3</span> Tokenization etc.</a></li>
<li><a class="nav-link" href="#keywords"><span class="header-section-number">3.4</span> Keywords</a></li>
<li>
<a class="nav-link" href="#dictionary-approaches"><span class="header-section-number">3.5</span> Dictionary Approaches</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#sentiment-analysis"><span class="header-section-number">3.5.1</span> Sentiment Analysis</a></li>
<li><a class="nav-link" href="#domain-specific-dictionaries"><span class="header-section-number">3.5.2</span> Domain-Specific Dictionaries</a></li>
<li><a class="nav-link" href="#using-pre-built-dictionaries"><span class="header-section-number">3.5.3</span> Using Pre-Built Dictionaries</a></li>
</ul>
</li>
<li><a class="nav-link" href="#assignments-1---due-date-eod-friday-week-4-1"><span class="header-section-number">3.6</span> Assignments 1 - Due Date: EOD Friday Week 4</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/svallejovera/cta_updated/blob/master/07-week3.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/svallejovera/cta_updated/edit/master/07-week3.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>PS9594: Computational Text Analysis</strong>" was written by Dr.¬†Sebasti√°n Vallejo Vera | Western University. It was last built on 2026-01-26.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
